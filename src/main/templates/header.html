<div ng-controller="headerController">
    <header>
        <div class="container">
            <nav class="navbar">
                <div class="{{layoutDirection.direction}}">
                    <div class="navbar-header" ng-class="{'navbar-right': layoutDirection.direction == 'rtl'}">
                        <img src="img/logo.png" alt="" title="PRAXIS" id="logoImg" class="navbar-brand logo"
                             tabindex="-1" ng-if="!showTestLogo()">
                        <img src="img/logo-test.png" alt="" title="PRAXIS" id="logoImg" class="navbar-brand logo"
                             tabindex="-1" ng-if="showTestLogo()">
                        <label class="version-number">{{ versionNumber() }}</label>
                    </div>
                    <div class="nav navbar-nav" ng-class="{'navbar-right': layoutDirection.direction != 'rtl'}">
                        <p class="text-right login-message">
                                <span ng-show="isLoggedIn">
                                     <strong>{{currentUser.userCredentials.username}}</strong> |
                                </span>
                                <span>
                                    <a description-popup
                                       dp-title="{{ resourceBundle.help }}"
                                       dp-desc="{{ getSupportEmailMessage() }}"
                                    >
                                    {{ resourceBundle.help }}
                                    </a>
                                </span>
                                <span ng-show="isLoggedIn">
                                    | <a ng-click="logout()" href="#/login"
                                       tabindex="-1">{{ resourceBundle.logoutLabel }}</a>
                                </span>
                        </p>
                        <ul class="nav navbar-nav" ng-class="{'navbar-right': layoutDirection.direction != 'rtl'}">
                            <li>
                                    <span class="glyphicon dhis-status"
                                          ng-class="{'glyphicon-cloud':!msgInQueue, 'glyphicon-cloud-upload':msgInQueue, 'dhis-online':isDhisOnline &amp;&amp; !poorConnection, 'dhis-poor-connection': poorConnection, 'dhis-offline':!isDhisOnline}"
                                          ng-attr-title="{{isDhisOnline &amp;&amp; !msgInQueue &amp;&amp; resourceBundle.connectedNoPendingRequests || isDhisOnline &amp;&amp; msgInQueue &amp;&amp; resourceBundle.connectedWithPendingRequests
                                        || !isDhisOnline &amp;&amp; !msgInQueue &amp;&amp; resourceBundle.notConnectedNoPendingRequests || !isDhisOnline &amp;&amp; msgInQueue &amp;&amp; resourceBundle.notConnectedWithPendingRequests}}"></span>
                            </li>
                            <li>
                                <div dropdown>
                                    <button type="button" class="btn btn-link dropdown-toggle hamburger-menu"
                                            dropdown-toggle ng-disabled="disabled">
                                        <i class="fa fa-bars" ng-attr-title="{{resourceBundle.menu}}"></i>
                                    </button>
                                    <ul class="dropdown-menu" role="menu" ng-if="isLoggedIn">
                                        <li ng-include="'templates/partials/download-data.html'"></li>
                                        <li><a href="#/selectProjectPreference" ng-if="hasRoles(['Projectadmin'])"
                                               tabindex="-1">{{resourceBundle.changeProject}}</a></li>
                                        <li class="divider"></li>
                                        <li><a href="" ng-click="gotoProductKeyPage()" tabindex="-1">{{
                                            resourceBundle.updateProductKeyMenuLabel }}</a></li>
                                        <li class="dropdown-submenu"
                                            ng-class="{'pull-left': layoutDirection.direction != 'rtl'}"
                                            ng-include="'templates/partials/clone.html'"></li>
                                    </ul>
                                    <ul class="dropdown-menu" role="menu" ng-if="!isLoggedIn">
                                        <li><a href="" ng-click="gotoProductKeyPage()" tabindex="-1">{{
                                            resourceBundle.updateProductKeyMenuLabel }}</a></li>
                                    </ul>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
        </div>
    </header>
    <div class="container hide-from-print {{layoutDirection.direction}}" style="padding-top:10px;" ng-if="isLoggedIn">
        <ul class="nav nav-tabs main-menu">
            <li role="presentation" ng-class="{ active: isActive('\/dashboard$')}"
                ng-if="hasRoles(['Coordination Level Approver', 'Observer', 'Project Level Approver', 'Data entry user'])">
                <a href="#/dashboard">
                    <i class="fa fa-home"></i>
                    {{ resourceBundle.homeMenuLabel }}
                </a>
            </li>
            <li role="presentation" ng-class="{ active: isActive('\/aggregate-data-entry')}"
                ng-if="hasRoles(['Data entry user'])">
                <a href="#/aggregate-data-entry">
                    <i class="fa fa-pencil"></i>
                    {{ resourceBundle.dataEntryLabel }}
                </a>
            </li>
            <li role="presentation" ng-class="{ active: isActive('\/data-approval')}"
                ng-if="hasRoles(['Project Level Approver', 'Coordination Level Approver'])">
                <a href="#/data-approval">
                    <i class="fa fa-check-square-o"></i>
                    {{ resourceBundle.approveDataLabel }}
                </a>
            </li>
            <li role="presentation" ng-class="{ active: isActive('\/data-approval')}" ng-if="hasRoles(['Observer'])">
                <a href="#/data-approval">
                    <i class="fa fa-database"></i>
                    {{resourceBundle.observerDataLabel}}
                </a>
            </li>
            <li role="presentation" ng-class="{ active: isActive('\/line-list')}" class="dropdown praxis-dropdown-menu"
                ng-if="hasRoles(['Data entry user']) &amp;&amp; (allUserModules | filter: {isLineListService:true}).length > 0"
                dropdown>
                <a class="dropdown-toggle" dropdown-toggle href="" role="button">
                    <i class="fa fa-pencil"></i>
                    {{ resourceBundle.lineListDataEntryMenuLabel }}
                    <i class="fa fa-caret-down"></i>
                </a>
                <ul class="dropdown-menu" role="menu">
                    <li ng-repeat="module in allUserModules | filter: {isLineListService:true} | orderBy:'displayName'">
                        <a class="submenu-item" ng-href="#/line-list-summary/{{module.id}}" tabindex="-1">{{module.displayName}}</a>
                    </li>
                </ul>
            </li>
            <li role="presentation" ng-class="{ active: isActive('\/reports') || isActive('\/projectReport') || isActive('\/opUnitReport') }"
                class="dropdown praxis-dropdown-menu"
                ng-if="hasRoles(['Coordination Level Approver', 'Observer', 'Project Level Approver', 'Data entry user']) &amp;&amp; allUserModules.length > 0"
                dropdown>
                <a class="dropdown-toggle" dropdown-toggle href="" role="button">
                    <i class="fa fa-bar-chart"></i>
                    {{ resourceBundle.reportsLabel }}
                    <i class="fa fa-caret-down"></i>
                </a>
                <ul class="dropdown-menu multi-level" role="menu">
                    <li class="dropdown-submenu"
                        ng-repeat="opUnitWithModule in allOpUnitsWithModules | orderBy: 'opUnitName' "
                        ng-class="{'pull-left': layoutDirection.direction == 'rtl' }">
                        <a class="dropdown-toggle">
                            {{ opUnitWithModule.opUnitName }}
                            <i class="fa"
                               ng-class="layoutDirection.direction == 'rtl' ? 'fa-caret-left' : 'fa-caret-right'"></i>
                        </a>
                        <ul class="dropdown-menu">
                            <li ng-repeat="module in opUnitWithModule.modules | orderBy:'name'">
                                <a class="submenu-item" ng-href="#/reports/{{ module.id }}" tabindex="-1">{{ module.name
                                    }}</a>
                            </li>
                            <li class="divider"></li>
                            <li>
                                <a class="submenu-item" href="#/opUnitReport/{{ opUnitWithModule.opUnitId }}">{{ opUnitWithModule.opUnitName }} {{ resourceBundle.reportLabel }}</a>
                            </li>
                        </ul>
                    </li>
                    <li class="clearfix"></li>
                    <li class="divider"></li>
                    <li>
                        <a class="dropdown-toggle" href="#/projectReport">
                            {{ resourceBundle.projectReportLabel }}
                        </a>
                    </li>
                </ul>
            </li>
            <li role="presentation" ng-class="{ active: isActive('\/notifications$')}"
                ng-if="hasRoles(['Coordination Level Approver', 'Observer', 'Project Level Approver', 'Data entry user'])">
                <a href="#/notifications"><i class="fa fa-bell-o"></i>
                    {{ resourceBundle.notificationsLabel }}
                </a>
            </li>
            <li role="presentation" ng-class="{ active: isActive('\/orgUnits$')}" ng-if="hasRoles(['Superadmin'])">
                <a href="#/orgUnits">
                    <i class="fa fa-globe"></i>
                    {{ resourceBundle.countryLabel }}
                </a>
            </li>
            <li role="presentation" ng-class="{ active: isActive('\/orgUnits$')}" ng-if="hasRoles(['Projectadmin'])">
                <a href="#/orgUnits">
                    <i class="fa fa-gear"></i>
                    {{ resourceBundle.projectsLabel }}
                </a>
            </li>
            <li ng-show="canChangeProject(isLoggedIn, hasRoles(['Coordination Level Approver']))"
                ng-class="layoutDirection.direction == 'rtl' ? 'pull-left' : 'pull-right'">
                <select name="project" class="select_project input-sm" ng-model="selectedProject"
                        ng-options="p.name for p in projects | orderBy:'name'"
                        ng-change="setSelectedProject(selectedProject)">
                </select>
            </li>
        </ul>
    </div>
</div>
