<div>
    <form name="approvalForm">
        <table class="table table-bordered msf-table" ng-if="itemsArePresent(itemsAwaitingApprovalAtUserLevel)">
            <caption class="msf-table-caption">{{resourceBundle.itemsAwaitingApprovalAtUserLevelLabel}}</caption>
            <thead>
            <tr>
                <th>{{resourceBundle.moduleLabel}}</th>
                <th ng-model="weeks">
                    <input type="checkbox" class="dashboard-form-checkbox select-all-checkbox"
                           ng-click="toggleSelectAll()"
                           ng-checked="selectedAllItemsForApproval" />
                    {{resourceBundle.weekLabelForApproval}}
                </th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="(moduleName, items) in itemsAwaitingApprovalAtUserLevel">
                <td>{{moduleName}}</td>
                <td>
                    <ul class="list-unstyled">
                        <li ng-repeat="item in items | orderBy: 'period'">
                            <input type="checkbox" class="dashboard-form-checkbox"
                                   ng-model="item.selectedForApproval"
                                   ng-change="toggleWeek()"
                            />
                            <a ng-href="{{ getTemplateUrl(item) }}" ng-class="{ 'error-label': item.failedToSync }">{{formatPeriods(item.period)}}</a>
                        </li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td></td>
                <td>
                    <input type="submit"
                           ng-disabled="(itemsAwaitingApprovalAtUserLevel | filter : { 'selectedForApproval': true}).length === 0"
                           value="{{resourceBundle.approveBtnValue}}" class="btn btn-default"
                           ng-click="bulkApprove()"/>
                </td>
            </tr>
            </tbody>
        </table>
    </form>
    <form>
        <table class="table dataentrytable" ng-if="itemsArePresent(itemsAwaitingSubmission) || itemsArePresent(itemsAwaitingApprovalAtOtherLevels)">
            <thead>
            <tr class="title">
                <th colspan="2">{{resourceBundle.itemsAwaitingDataSubmissionLabel}}</th>
                <th colspan="1">{{resourceBundle.awaitingApproval}}</th>
            </tr>
            <tr>
                <th>{{resourceBundle.moduleLabel}}</th>
                <th>{{resourceBundle.weekLabel}}</th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="moduleName in moduleNames">
                <td>{{moduleName}}</td>
                <td>
                    <ul class="list-unstyled">
                        <li ng-repeat="item in itemsAwaitingSubmission[moduleName] | orderBy: 'period'" ng-if="item.active">
                            <span>{{formatPeriods(item.period)}}</span>
                        </li>
                    </ul>
                </td>
                <td>
                    <ul class="list-unstyled">
                        <li ng-repeat="item in itemsAwaitingApprovalAtOtherLevels[moduleName] | orderBy: 'period'" ng-if="item.active">
                            <span class="period">{{formatPeriods(item.period)}}</span>
                            <span ng-if="item.awaitingActionAtProjectLevelApprover">- {{ resourceBundle.itemsAwaitingApprovalAtProjectLevel }}</span>
                            <span ng-if="item.awaitingActionAtCoordinationLevelApprover">- {{ resourceBundle.itemsAwaitingApprovalAtCoordinationLevel }}</span>
                        </li>
                    </ul>
                </td>
            </tr>
            </tbody>
        </table>
    </form>
</div>
